
<html>
    <head>
        <title>F1 Racing</title>
    </head>

    <body>
        <div class="mainContainer">
            <div id="teamPoints">
                <table BORDER=2>
                    <tr>
                        <th>Team Name</th>
                        <th>Total Points</th>
                    </tr>
                    <tr>
                        <td>${name}</td>
                        <td>Race Name</td>
                    </tr>
            </div>

            <div id="driverPoints">
                <table BORDER=2>
                <tr>
                    <th>Driver Name</th>
                    <th>Race Name</th>
                    <th>Race Place</th>
                    <th>Race Points</th>
                    <th>Grid Position</th>
                    <th>Qualifying Points</th>
                    <th>total Points</th>

                </tr>
                <tr>
                <td>${name}</td>
                <td>Race Name</td>
                <td>${points}</td>
                <td>${gridPosition}</td>
                <td>${gridPoints()}</td>
                <td>${gridPoints()}</td>
                <td>${gridPoints()}</td>
                </tr>
                
            </div>

            <div class="resultsContainer">
                <div id="raceResults"></div>
            </div>
            </div>
    </body>
<script>
    var danTeam = [];
    var tyTeam = [];
    var kaylaTeam = [];
    
    var myStuff = {
        seasonRaces: [],
        amountOfRaces: 23,
        topTeams: [
        danTopTeam = [],  
        tyTopTeam = [],
        kaylaTopTeam = [],
        ],
        // danTopTeam: [],
        // tyTopTeam: [],
        // kaylaTopTeam: [],
        // danBottomTeam: [],
        // tyBottomTeam: [],
        // kaylaBottomTeam: [],
    };

    //starting point for app
    async function main(){
        await getRaces();
        console.log(myStuff.seasonRaces);
        raceResults(racer, myStuff.seasonRaces, scoreSheet);
    }

    main()

    async function getRaces(){
        for (let m = 10; m <= myStuff.amountOfRaces; m++) { // 23 races in the season.
            const raceURL = `http://ergast.com/api/f1/2022/${m}/results.json`
            var response = await fetch(raceURL)
            // var race = await getAPI(raceURL);
            var fullDetailRace = await response.json();
            console.log(fullDetailRace);
            if(!fullDetailRace || fullDetailRace.MRData.RaceTable.Races.length === 0){return}
            var race = fullDetailRace.MRData.RaceTable.Races[0];
            if(race){
                myStuff.seasonRaces.push(race);
            }
            // if(!race){return;} 
            // myStuff.seasonRaces.push(race);
        } 
    }
    
    

    const racer = [
        {
            code: "SAI",
            name: "Carlos Sainz",
            nationality: "Spanish",
            construction: "FER",
            pointsTotal: 0
        },
        {
            code: "LEC",
            name: "Carles Leclerc",
            nationality: "Monaco",
            construction: "FER",
            pointsTotal: 0
        },
        {
            code: "HAM",
            name: "Lewis Hamilton",
            nationality: "English",
            construction: "MER",
            pointsTotal: 0
        },
        {
            code: "RUS",
            name: "George Russel",
            nationality: "English",
            construction: "MER",
            pointsTotal: 0
        },
        {
            code: "VER",
            name: "Max Verstappen",
            nationality: "Dutch",
            construction: "RBR",
            pointsTotal: 0
        },
        {
            code: "PER",
            name: "Sergio Perez",
            nationality: "Mexico",
            construction: "RBR",
            pointsTotal: 0
        }
    ]

    var scoreSheet = [
        {
            position: 1,
            points: 25
        },
        {
            position: 2,
            points: 18
        },
        {
            position: 3,
            points: 15
        },
        {
            position: 4,
            points: 12
        },
        {
            position: 5,
            points: 10
        },
        {
            position: 6,
            points: 8
        },
        {
            position: 7,
            points: 6
        },
        {
            position: 8,
            points: 4
        },
        {
            position: 9,
            points: 2
        },
        {
            position: 10,
            points: 1
        },
    ]

    // var silverstone = [
    //     {
    //     position: 1,
    //     driver: "SAI"
    //     },
    //     {
    //     position: 2,
    //     driver: "PER"
    //     },
    //     {
    //     position: 3,
    //     driver: "HAM"
    //     },
    //     {
    //     position: 4,
    //     driver: "LEC"
    //     }
    // ]

    // var austrian = [
    // {
    //     position: 1,
    //     driver: "LEC"
    //     },
    //     {
    //     position: 2,
    //     driver: "VER"
    //     },
    //     {
    //     position: 3,
    //     driver: "HAM"
    //     },
    //     {
    //     position: 4,
    //     driver: "RUS"
    //     }
    // ]

    // console.log(scoreSheet);
    var Silverstone = []
    var races = [];
    raceResultsTable ="";

    
    
    function raceResults(array, race, scoreSheet){
        
        const element = document.getElementById("raceResults");
        console.log(myStuff);
        pointsAdder();
        //For loop that counts how many races have happened in our season
        for (let n = 0; n <= myStuff.seasonRaces.length ; n++) {
            
            // creates table for GrandPrix
            for (let k = 0; k < myStuff.seasonRaces[n].Results.length; k++) {

                var raceName = myStuff.seasonRaces[n].raceName;
                var driverName = myStuff.seasonRaces[n].Results[k].Driver.givenName + " " + myStuff.seasonRaces[n].Results[k].Driver.familyName
                var name = myStuff.seasonRaces[n].Results[k].Driver.code;
                var points = myStuff.seasonRaces[n].Results[k].points;
                var gridPosition = myStuff.seasonRaces[n].Results[k].grid;
                
                // dans top team VER PER Ty Top HAM LEC Kay RUS SAI
                if(name === "VER" || name === "PER"){
                    var playerName = "Dan"
                    addDriverToTeam(myStuff.topTeams[0])
                }
                if(name === "HAM" || name === "LEC"){
                    var playerName = "Tyler"
                    addDriverToTeam(myStuff.topTeams[1])
                }
                if(name === "RUS" || name === "SAI"){
                    var playerName = "Kayla"
                    addDriverToTeam(myStuff.topTeams[2])   
                }

                function addDriverToTeam(team){
                    var teamDriver = {
                        playerName:playerName,
                        race: raceName,
                        driverName: driverName,
                        code: name,
                        racePoints: points,
                        gridPosition: gridPosition,
                        gridPoints: gridPoints()
                    }
                    team.push(teamDriver)
                    // console.log(team);
                }
                // var qualPoints = gridPoints()
                // console.log(gridPoints());
                
                function gridPoints() { //scoreSheet.length
                    for (let o = 0; o < scoreSheet.length; o++) {
                        if(scoreSheet[o].position == gridPosition){ 
                            // var qualifyingPoints = scoreSheet[o].points
                            return scoreSheet[o].points;
                        }
                        else if (gridPosition > 10 || gridPosition == 0){
                            return 0;
                        }
                    }
                }

                if(k === 0){
                    raceResultsTable += `
                         
                        <table BORDER=2>
                            ${raceName} <BR>
                        <tr>
                            <th>Driver Code</th>
                            <th>Race Place</th>
                            <th>Race Points</th>
                            <th>Grid Position</th>
                            <th>Qualifying Points</th>
                        </tr>`
                    raceResultsTable += `<tr>
                        <td>${name}</td>
                        <td>${k+1}</td>
                        <td>${points}</td>
                        <td>${gridPosition}</td>
                        <td>${gridPoints()}</td>
                        </tr>`
                }
                else{  
                    raceResultsTable += `<tr>
                            <td>${name}</td>
                            <td>${k+1}</td>
                            <td>${points}</td>
                            <td>${gridPosition}</td>
                            <td>${gridPoints()}</td>
                            </tr>`
                }
                
            }
            element.innerHTML = `
                        ${raceResultsTable}
                        </table>`

        }
    }

    function pointsAdder(){
        myStuff.topTeams[0]


    }


    var kaylaPoints = kaylaTeam[0].pointsTotal + kaylaTeam[1].pointsTotal;
    var danPoints = danTeam[0].pointsTotal + danTeam[1].pointsTotal;
    var tyPoints = tyTeam[0].pointsTotal + tyTeam[1].pointsTotal;
    
    console.log("Kayla's team points: ", kaylaPoints);
    console.log("Dan's team points: ", danPoints);
    console.log("Tyler's team points: ",tyPoints);
    // console.log(racer[0].code);
    // console.log(racer[0].pointsTotal);
    
</script>

</html>